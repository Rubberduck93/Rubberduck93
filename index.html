<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>This is a reproduction of http://iquantny.tumblr.com/post/129373499164/this-is-quantifiably-the-best-month-to-go-to-the</title>
		<script src="https://d3js.org/d3.v4.min.js"></script>
		<style type="text/css">
			/* No style rules here yet */		
		</style>
	</head>
	<body>
		<script type="text/javascript">
			
			//Width and height
		      var w = 500;
		      var h = 300;
		      var barPadding = 1;
		      var padding = 40;
		      var index0 = 0;
		      var index1 = 0;
		      var index2 = 0;
		      var index3 = 0;
			// istedet for indexs, skal vi ligge til Jan, Feb osv
		      var JanMonth = 0;
			
			var dataset, xScale, yScale;  //Empty, for now
		      //For converting strings to Dates
		      var parseTime = d3.timeParse("%m/%d/%y");
		      //For converting Dates to strings
		      var formatTime = d3.timeFormat("%B %e %Y %Z");

		     //Create SVG element
				var svg = d3.select("body")
				      .append("svg")
				      .attr("width", w)
				      .attr("height", h);

		      //Function for converting CSV values from strings to Dates and numbers
		      var rowConverter = function(d) {
			return {
			  Index: parseInt(d.Index),
			  Month: d.Month,
			  Count: parseInt(d.Count)
			};
		      }
		      
		      d3.csv("green_markets.csv", rowConverter, function(data) {
			      
			      //alert(Count.length);
			      //Copy data into global dataset
				dataset = data;
			        
			      //
			      // Bars
				svg.selectAll("rect")
				  .data(data)
				  .enter()
				  .append("rect")
				  .attr("fill", function(d) {
				      return "rgb(0, " + Math.round(d.Count * 20) + ", 0)";
				  })
			      	  
				  .attr("x", function(d, i) {
					if (d.Month == Jan) {
						return 50;
					}
					/*
					if (d.Index == 0) {
						return 50;
						//return h - d.Count * 4;
					} 
					if (d.Index == 1) {
						return 100;
					}
					if (d.Index == 2) {
						return 150;
					} 
					if (d.Index == 3) {
						return 200;
					}
					*/
				      //return i * (w/data.length);
				  })
				  .attr("y", function(d) {
					if (d.Index == 0) {
						//alert(index0);
						index0 += d.Count;
						return h - index0 * 4;
					} 
					if (d.Index == 1) {
						index1 += d.Count;
						return h - index1 * 4;
						
					}
					if (d.Index == 2) {
						index2 += d.Count;
						return h - index2 * 4;
						
					} 
					if (d.Index == 3) {
						index3 += d.Count;
						return h - index3 * 4;
						
					}
				      //return h - d.Index * 4; //Height minus data value
				  })
				  .attr("width", w / data.length - barPadding)
				  .attr("height", function(d) {
				      if (d.Index == 0) {
						return d.Count * 4;
					} 
					if (d.Index == 1) {
						return d.Count * 4;
					}
					if (d.Index == 2) {
						return d.Count * 4;
					} 
					if (d.Index == 3) {
						return d.Count * 4;
					}
				  });
			      
			      
			      
			      /*
				//Create scale functions
				xScale = d3.scaleTime()
					 .domain([
					  d3.min(dataset, function(d) { return d.Count; }),
					  d3.max(dataset, function(d) { return d.Count; })
					])
			       alert(dataset.length);
			      */
			      
			      
			      // xAxis
			      /*
			    var xAxis = d3.axisBottom(xScale).ticks(5);
			      
			      svg.append("g")
				.call(xAxis);
			      */
			     /* 
		           //Define Y axis
			    var yAxis = d3.axisLeft()
			    .ticks(5);
				    
			    
				    
			      
			      
			     
			      //Create Y axis
			    svg.append("g")
			    .attr("class", "axis")
			    .attr("transform", "translate(" + padding + ",0)")
			    .call(yAxis);

			    // SVG Axis
			    svg.append("g") // Group element
			    .attr("class", "axis") //Assign "axis" class
			    .attr("transform", "translate(0," + (h - padding) + ")") // translate(x,y)
			    .call(xAxis);
			      
			     */ 
		      });
		      
		      
		      

		</script>
	</body>
</html>
