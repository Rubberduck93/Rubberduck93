<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>This is a reproduction of http://iquantny.tumblr.com/post/129373499164/this-is-quantifiably-the-best-month-to-go-to-the</title>
		<script src="https://d3js.org/d3.v4.min.js"></script>
		<style type="text/css">
			/* No style rules here yet */
		</style>
	</head>
	<body>
		<p id="FF">Fresh Fruit</p>
    		<p id="FV">Fresh Vegetable</p>
		<p id="SF">Storage Fruit</p>
    		<p id="SV">Storage Vegetable</p>

		<script type="text/javascript">

			//Width and height
		      var w = 800;
		      var h = 300;
		      var barPadding = 1;
		      var padding = 40;
		      var JanMonth = 0;
			var FebMonth = 0;
			var MarMonth = 0;
			var AprMonth = 0;
			var MayMonth = 0;
			var JunMonth = 0;
			var JulMonth = 0;
			var AugMonth = 0;
			var SepMonth = 0;
			var OctMonth = 0;
			var NovMonth = 0;
			var DecMonth = 0;

			var dataset, xScale, yScale;  //Empty, for now
		      //For converting strings to Dates
		      //var parseTime = d3.timeParse("%m/%d/%y");
			var parseTime = d3.timeParse("%b");
		      //For converting Dates to strings
		      //var formatTime = d3.timeFormat("%B %e %Y %Z");
			//var formatTime = d3.time.format("%b");



		      //Function for converting CSV values from strings to Dates and numbers
		      var rowConverter = function(d) {
			return {
			  Index: parseInt(d.Index),
			 //Month: parseTime(d.Month),
			 // Month: formatTime(d.Month),
			  Month: d.Month,
			  Count: parseInt(d.Count)
			};
		      }

		      d3.csv("green_markets.csv", rowConverter, function(data) {


			      //Copy data into global dataset
				dataset = data;
			      // xscale = d3.scaleBand


			      var xScale = d3.scaleBand().domain(['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']).
			      range([0,w]).paddingInner(0.05);

			      /*
			      var xScale =
			    d3.scaleTime()
			    .domain([d3.min(dataset, function(d) { return d.Month; }),
				     d3.max(dataset, function(d) { return d.Month; })])
			    .range([padding, 600+padding]);
				*/
				// xAxis
				var xAxis = d3.axisBottom(xScale)
				.ticks(12);
			     //Create SVG element
					var svg = d3.select("body")
					      .append("svg")
					      .attr("width", w)
					      .attr("height", h);

			      //
			      // Bars
				svg.selectAll("rect")
				  .data(data)
				  .enter()
				  .append("rect")
				  .attr("fill", function(d) {
				      	if (d.Index == 0) {
						return "rgb(200,0, 0)";
					}
					if (d.Index == 1) {
						return "rgb(100,0, 0)";
					}
					if (d.Index == 2) {
						return "rgb(0,200, 0)";
					}
					if (d.Index == 3) {
						return "rgb(0,100, 0)";
					}

					//return "rgb(0, " + Math.round(d.Count * 20) + ", 0)";
				  })

				  .attr("x", function(d, i) { //scaleband
					//alert(d.Month);
					return xScale(d.Month) + 24;

					/*
					if (d.Month == "Jan") {
						return 50;
					}
					if (d.Month == "Feb") {
						return 100;
					}
					if (d.Month == "Mar") {
						return 150;
					}
					if (d.Month == "Apr") {
						return 200;
					}
					if (d.Month == "May") {
						return 250;
					}
					if (d.Month == "Jun") {
						return 300;
					}
					if (d.Month == "Jul") {
						return 350;
					}
					if (d.Month == "Aug") {
						return 400;
					}
					if (d.Month == "Sep") {
						return 450;
					}
					if (d.Month == "Oct") {
						return 500;
					}
					if (d.Month == "Nov") {
						return 550;
					}
					if (d.Month == "Dec") {
						return 600;
					}
					*/

				      //return i * (w/data.length);
				  })
				  .attr("y", function(d) {
					if (d.Month == "Jan") {
						JanMonth += d.Count;
						return h - padding - JanMonth * 4;
					}
					if (d.Month == "Feb") {
						FebMonth += d.Count;
						return h - padding - FebMonth * 4;
					}
					if (d.Month == "Mar") {
						MarMonth += d.Count;
						return h - padding - MarMonth * 4;
					}
					if (d.Month == "Apr") {
						AprMonth += d.Count;
						return h - padding - AprMonth * 4;
					}
					if (d.Month == "May") {
						MayMonth += d.Count;
						return h - padding - MayMonth * 4;
					}
					if (d.Month == "Jun") {
						JunMonth += d.Count;
						return h - padding - JunMonth * 4;
					}
					if (d.Month == "Jul") {
						JulMonth += d.Count;
						return h - padding - JulMonth * 4;
					}
					if (d.Month == "Aug") {
						AugMonth += d.Count;
						return h - padding - AugMonth * 4;
					}
					if (d.Month == "Sep") {
						SepMonth += d.Count;
						return h - padding - SepMonth * 4;
					}
					if (d.Month == "Oct") {
						OctMonth += d.Count;
						return h - padding - OctMonth * 4;
					}
					if (d.Month == "Nov") {
						NovMonth += d.Count;
						return h - padding - NovMonth * 4;
					}
					if (d.Month == "Dec") {
						DecMonth += d.Count;
						return h - padding - DecMonth * 4;
					}
				      //return h - d.Index * 4; //Height minus data value
				  })
				  .attr("width", w / data.length - barPadding)
				  .attr("height", function(d) {
				        return d.Count * 4;
					/*
					if (d.Index == 0) {
						return d.Count * 4;
					}
					if (d.Index == 1) {
						return d.Count * 4;
					}
					if (d.Index == 2) {
						return d.Count * 4;
					}
					if (d.Index == 3) {
						return d.Count * 4;
					}
					*/
				  });

			      //Create X axis
			    svg.append("g") // Group element
			    .attr("class", "x axis") //Assign "axis" class
			    .attr("transform", "translate(0," + (h-padding) + ")") // translate(x,y)
			    .call(xAxis);
			      /*
			      // Text
				 svg.selectAll("text")
				  .data(data)
				  .enter()
				  .append("text")
				  .text(function(d) {
				      return d.Count;
				  })
				  .attr("x", function(d, i) {
				      return i * (w / data.length) + (w / data.length - barPadding) / 2;
				  })
				  .attr("y", function(d) {
				      return h - (d.Months * 4) + 14;
				  })
				  .attr("font-family", "sans-serif")
				  .attr("font-size", "11px")
				  .attr("text-anchor", "middle")
				  .attr("fill", "white");
			      */


			      /*
				//Create scale functions
				xScale = d3.scaleTime()
					 .domain([
					  d3.min(dataset, function(d) { return d.Count; }),
					  d3.max(dataset, function(d) { return d.Count; })
					])
			       alert(dataset.length);
			      */


			      // xAxis
			      /*
			    var xAxis = d3.axisBottom(xScale).ticks(5);

			      svg.append("g")
				.call(xAxis);
			      */
			     /*
		           //Define Y axis
			    var yAxis = d3.axisLeft()
			    .ticks(5);






			      //Create Y axis
			    svg.append("g")
			    .attr("class", "axis")
			    .attr("transform", "translate(" + padding + ",0)")
			    .call(yAxis);

			    // SVG Axis
			    svg.append("g") // Group element
			    .attr("class", "axis") //Assign "axis" class
			    .attr("transform", "translate(0," + (h - padding) + ")") // translate(x,y)
			    .call(xAxis);

			     */
		      });




		</script>
	</body>
</html>
